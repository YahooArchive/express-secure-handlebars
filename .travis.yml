language: node_js
node_js:
- '0.11'
- '0.10'

notifications:
    email:
        recipients:
            - neraliu@yahoo-inc.com
    on_success: change
    on_failure: always

##
# Ensures that the git tag matches the version in package.json
#
# Example:
# If package.version is `0.0.1` then the git tag must be `0.0.1`
##
after_success:
    - test $(cat $TRAVIS_BUILD_DIR/package.json | grep version | awk '{print $2}' | sed 's/"//g' | sed 's/,//g') = $TRAVIS_TAG && export VALID_VERSION=true

deploy:
    provider: npm
    email: neraliu@yahoo-inc.com
    api_key: 
        secure: KEY_HERE
    on:
        condition: $VALID_VERSION = true
        tags: true
        all_branches: true
